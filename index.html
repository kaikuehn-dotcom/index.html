<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>BRL ‚Üî EUR Rechner</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
:root{
  --bg:#f3f6fb; --card:#fff; --accent:#2563eb; --accentSoft:#e8efff;
  --best:#e9fbf0; --bestBorder:#16a34a; --border:#d7dbe3;
  --input:#eef2ff; --muted:#94a3b8;
}
body{margin:0;font-family:-apple-system,BlinkMacSystemFont,system-ui,sans-serif;
  background:linear-gradient(180deg,#f3f6fb,#eef2f7);color:#0f172a}
.app{max-width:980px;margin:auto;padding:16px}
h1{font-size:22px;margin:12px 0 16px}
.card{background:var(--card);border-radius:16px;padding:16px;margin-bottom:16px;
  box-shadow:0 6px 20px rgba(15,23,42,.08)}
label{font-size:13px;font-weight:700;margin:10px 0 4px;display:block}
input{width:100%;padding:12px;font-size:16px;border-radius:12px;border:2px solid var(--input)}
input:focus{outline:none;border-color:var(--accent);box-shadow:0 0 0 3px var(--accentSoft)}
input.inactive{background:#f8fafc;color:var(--muted)}
.grid{display:grid;gap:12px}
@media(min-width:760px){.grid{grid-template-columns:1fr 1fr}}
.toggle{display:flex;gap:6px;flex-wrap:wrap}
.toggle button{flex:1 1 220px;border:none;padding:10px;font-weight:800;
  border-radius:999px;background:#e5e9f2;cursor:pointer}
.toggle button.active{background:var(--accent);color:#fff}
table{width:100%;border-collapse:collapse;font-size:14px}
th,td{padding:10px;border-bottom:1px solid var(--border);text-align:right}
th:first-child,td:first-child{text-align:left}
tr.best{background:var(--best)}
.badge{background:#16a34a;color:#fff;font-size:12px;padding:4px 10px;border-radius:999px;margin-left:6px}
.top-best{border:2px solid var(--bestBorder);background:linear-gradient(135deg,#ecfdf5,#f0fdf4)}
.small{font-size:12px;color:#475569}
</style>
</head>

<body>
<div class="app">

<h1>BRL ‚Üî EUR Vergleich (ATM & Kreditkarte)</h1>

<div class="card">
  <div class="toggle">
    <button id="mATM_BRL">ATM ¬∑ BRL</button>
    <button id="mATM_EUR">ATM ¬∑ EUR</button>
    <button id="mCARD_BRL">Karte ¬∑ BRL</button>
    <button id="mCARD_EUR">Karte ¬∑ EUR</button>
  </div>

  <div class="grid" style="margin-top:14px">
    <div>
      <label>BRL</label>
      <input id="inBRL" type="number">
    </div>
    <div>
      <label>EUR</label>
      <input id="inEUR" type="number">
    </div>
  </div>

  <div class="grid" style="margin-top:10px">
    <div>
      <label>Kreditkarte FX %</label>
      <input id="cardFx" type="number" step="0.01">
    </div>
    <div class="small" style="padding-top:26px">
      Nur bei Kreditkarte relevant
    </div>
  </div>

  <p class="small" id="hint"></p>
</div>

<div id="opts"></div>

<div class="card top-best">
  <h2>üèÜ Beste Option</h2>
  <div id="best"></div>
</div>

<div class="card">
<table>
<thead><tr><th>Option</th><th>Ergebnis</th><th>Eff. Kurs</th></tr></thead>
<tbody id="rows"></tbody>
</table>
</div>

</div>

<script>
const STORAGE_KEY="brl_eur_calc_v1";

let state={
  mode:"ATM_BRL",
  brl:5000,
  eur:0,
  cardFx:1.55,
  options:[
    {name:"N26",rate:6.36,pct:1.7,atm:25,limit:2500},
    {name:"Wise",rate:6.20,pct:0,atm:0,limit:999999}
  ]
};

function save(){
  localStorage.setItem(STORAGE_KEY,JSON.stringify(state));
}
function load(){
  const s=localStorage.getItem(STORAGE_KEY);
  if(s) state=JSON.parse(s);
}

load();

const opts=document.getElementById("opts"),
      rows=document.getElementById("rows"),
      best=document.getElementById("best");

function renderOptions(){
  opts.innerHTML="";
  state.options.forEach(o=>{
    const d=document.createElement("div");
    d.className="card";
    d.innerHTML=`
      <b>${o.name}</b>
      <div class="grid">
        <div><label>Kurs</label><input value="${o.rate}"></div>
        <div><label>Bank %</label><input value="${o.pct}"></div>
      </div>`;
    const ins=d.querySelectorAll("input");
    ins[0].oninput=e=>{o.rate=+e.target.value;save();calc()};
    ins[1].oninput=e=>{o.pct=+e.target.value;save();calc()};
    opts.appendChild(d);
  });
}

function calc(){
  const brl=state.brl, eur=state.eur, fx=state.cardFx/100;
  const out=state.options.map(o=>{
    let res,eff;
    if(state.mode==="CARD_BRL"){
      res=(brl/o.rate)*(1+o.pct/100)*(1+fx); eff=brl/res;
      return{n:o.name,main:res.toFixed(2)+" EUR",eff};
    }
    if(state.mode==="CARD_EUR"){
      res=eur*o.rate/(1+o.pct/100)/(1+fx); eff=res/eur;
      return{n:o.name,main:Math.round(res)+" BRL",eff};
    }
    if(state.mode==="ATM_EUR"){
      const base=eur/(1+o.pct/100);
      const brlNet=Math.min(o.limit,base*o.rate-o.atm);
      eff=brlNet/eur;
      return{n:o.name,main:Math.round(brlNet)+" BRL",eff};
    }
    const n=Math.ceil(brl/o.limit);
    res=((brl+n*o.atm)/o.rate)*(1+o.pct/100);
    eff=brl/res;
    return{n:o.name,main:res.toFixed(2)+" EUR",eff};
  }).sort((a,b)=>b.eff-a.eff);

  rows.innerHTML="";
  out.forEach((r,i)=>{
    rows.innerHTML+=`<tr class="${i==0?"best":""}">
      <td>${r.n}${i==0?'<span class="badge">BEST</span>':''}</td>
      <td>${r.main}</td><td>${r.eff.toFixed(3)}</td></tr>`;
  });
  best.innerHTML=`<b>${out[0].n}</b><br>${out[0].main}`;
}

function setMode(m){
  state.mode=m;
  inBRL.classList.toggle("inactive",m.includes("EUR"));
  inEUR.classList.toggle("inactive",!m.includes("EUR"));
  if(m.includes("EUR")) state.brl=0; else state.eur=0;
  save(); calc();
}

["ATM_BRL","ATM_EUR","CARD_BRL","CARD_EUR"].forEach(k=>{
  document.getElementById("m"+k).onclick=()=>{
    document.querySelectorAll(".toggle button").forEach(b=>b.classList.remove("active"));
    document.getElementById("m"+k).classList.add("active");
    setMode(k);
  };
});

inBRL.value=state.brl;
inEUR.value=state.eur;
cardFx.value=state.cardFx;

[inBRL,inEUR,cardFx].forEach(i=>i.oninput=()=>{
  state.brl=+inBRL.value||0;
  state.eur=+inEUR.value||0;
  state.cardFx=+cardFx.value||0;
  save(); calc();
});

document.getElementById("m"+state.mode).classList.add("active");

renderOptions();
calc();
</script>

</body>
</html>
